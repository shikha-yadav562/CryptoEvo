<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DES Protocol - Pro Edition</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@300;500;700&display=swap" rel="stylesheet">

<style>
:root {
    --neon-blue: #00d2ff;
    --neon-purple: #9d50bb;
    --neon-yellow: #fde047;
    --glass: rgba(6, 11, 25, 0.9);
    --glass-border: rgba(0, 210, 255, 0.3);
}

*{box-sizing:border-box}
body{
    background:#020617; color:#f1f5f9;
    font-family: 'JetBrains Mono', monospace;
    text-align:center; margin:0; padding-bottom:100px;
    overflow-x: hidden;
}

#three-canvas { position: fixed; top: 0; left: 0; z-index: -1; }

/* CYBER GRID (Original) */
body::after {
    content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-image: radial-gradient(circle at 1px 1px, rgba(0, 210, 255, 0.1) 1px, transparent 0);
    background-size: 40px 40px; pointer-events: none; z-index: 0;
}

/* --- Sidebar & Nav Styling from Vigenere --- */
.glass-hud {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(25px);
    border: 1px solid rgba(0, 210, 255, 0.2);
}

#sidebar {
    transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    z-index: 150;
}
.sidebar-closed { transform: translateX(-100%); }
.sidebar-open { transform: translateX(0); }

.font-header {
    font-family: 'Orbitron', sans-serif;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 5px;
    color: #fff;
}

h1.scramble-main {
    font-family: 'Orbitron', sans-serif;
    letter-spacing: 10px; font-size: 2.5rem;
    text-shadow: 0 0 25px var(--neon-blue);
    margin: 120px 0 40px; /* Adjusted for fixed nav */
}

/* --- Original DES Components (Untouched) --- */
.controls {
    background: var(--glass);
    backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border);
    max-width: 800px; margin: 0 auto 40px;
    padding: 30px; border-radius: 20px;
    position: relative; z-index: 10;
    box-shadow: 0 0 40px rgba(0, 210, 255, 0.2);
}

input {
    padding: 15px; margin: 8px; width: 280px;
    border-radius: 12px; border: 1px solid var(--glass-border);
    background: rgba(0,0,0,0.6); color: var(--neon-blue);
    outline: none; transition: 0.4s;
    font-family: 'Orbitron'; font-size: 14px;
}
input:focus { border-color: var(--neon-blue); box-shadow: 0 0 20px rgba(0, 210, 255, 0.5); }

button.original-btn {
    padding: 14px 35px; border-radius: 12px; border: 1px solid var(--neon-blue);
    margin: 10px 5px; cursor: pointer; font-weight: 700;
    font-family: 'Orbitron'; text-transform: uppercase;
    background: transparent; color: var(--neon-blue);
    transition: 0.4s; letter-spacing: 2px;
}
button.original-btn:hover { background: var(--neon-blue); color: #000; box-shadow: 0 0 30px var(--neon-blue); transform: translateY(-3px); }

#container { 
    width: 95vw; margin: 0 auto;
    display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
    gap: 25px; justify-content: center; padding: 20px;
}

.card {
    background: var(--glass);
    backdrop-filter: blur(15px);
    border: 1px solid var(--glass-border);
    border-radius: 20px; padding: 25px;
    min-height: 250px; display: flex;
    flex-direction: column; justify-content: space-between;
    text-align: left; opacity: 0; transform: translateY(30px);
    box-shadow: 0 0 15px rgba(0, 210, 255, 0.2);
    transition: box-shadow 0.4s ease;
}

.card:hover {
    box-shadow: 0 0 30px rgba(0, 210, 255, 0.5);
    border-color: var(--neon-blue);
}

.answer-box-wrapper { grid-column: 1 / -1; display: flex; justify-content: center; margin-top: 30px; }
.answer-box {
    background: rgba(0, 210, 255, 0.1);
    border: 2px solid var(--neon-blue);
    border-radius: 15px; padding: 40px;
    width: 100%; max-width: 900px;
    text-align: center;
    box-shadow: 0 0 60px var(--neon-blue), inset 0 0 20px var(--neon-blue);
    animation: finalGlow 2s infinite alternate;
}

@keyframes finalGlow {
    from { box-shadow: 0 0 40px var(--neon-blue), inset 0 0 10px var(--neon-blue); }
    to { box-shadow: 0 0 70px var(--neon-blue), inset 0 0 30px var(--neon-blue); }
}

.card h3 { 
    color: var(--neon-blue); font-family: 'Orbitron'; 
    margin-bottom: 12px; font-size: 15px; letter-spacing: 1px;
    border-bottom: 1px solid var(--glass-border); padding-bottom: 8px;
}

.code { 
    background: #020617; padding: 12px; border-radius: 8px; font-size: 11px; 
    word-break: break-all; color: var(--neon-blue);
    border: 1px solid rgba(0, 210, 255, 0.2); font-family: 'JetBrains Mono';
}

.split { display: flex; gap: 10px; margin-top: 10px; }
.half { 
    flex: 1; background: rgba(0,0,0,0.4); padding: 10px; 
    border-radius: 8px; font-size: 10px; border: 1px solid var(--glass-border);
}
.half b { color: var(--neon-yellow); display: block; margin-bottom: 4px; font-size: 12px; }
.controls input{padding: 5px 10px;}

@media (max-width: 800px) { #container { grid-template-columns: 1fr; } }
</style>
</head>

<body>
<canvas id="three-canvas"></canvas>

<aside id="sidebar" class="fixed top-0 left-0 h-full w-80 glass-hud border-r border-cyan-500/30 sidebar-closed p-0 overflow-y-auto">
    <div class="p-8 flex justify-between items-center border-b border-white/10 bg-black/20 text-left">
        <div>
            <span class="font-header text-xs font-black text-cyan-400 tracking-[0.3em] uppercase block">Navigation</span>
            <span class="text-[9px] text-gray-500 font-mono">ID: DES_PROTOCOL_01</span>
        </div>
        <button onclick="toggleSidebar()" class="w-10 h-10 flex items-center justify-center border border-white/10 rounded-full hover:bg-cyan-500 hover:text-black transition-all group">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
        </button>
    </div>
    <div class="p-4 space-y-2">

            <!-- Home -->
            <a href="homepage.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Return Home
                    </h4>
                </div>
            </a>

            <a href="caeser.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Caeser Cipher
                    </h4>
                </div>
            </a>

            <a href="modified.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Modified Ceaser Cipher
                    </h4>
                </div>
            </a>

            <!-- Active: Vigen√®re -->
             <a href="Vigenere.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Vigenere Cipher
                    </h4>
                </div>
            </a>
            

            <a href="Playfair2.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Playfair Cipher
                    </h4>
                </div>
            </a>

            <a href="vernam.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Vernam Cipher
                    </h4>
                </div>
            </a>


            <a href="hill.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Hill Cipher
                    </h4>
                </div>
            </a>

            <a href="vernam.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        Vernam Cipher
                    </h4>
                </div>
            </a>

            <a href="aes.html" class="group flex flex-col gap-1 p-3 rounded-md border-l-4 border-transparent
              hover:border-cyan-400 hover:bg-cyan-400/10
              transition-all duration-300">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg opacity-80 group-hover:opacity-100">üè†</span> -->
                    <h4 class="font-header text-[11px] font-semibold tracking-widest uppercase
                       text-gray-300 group-hover:text-cyan-400">
                        AES
                    </h4>
                </div>
            </a>

             <div class="flex flex-col gap-1 p-3 rounded-md border-l-4 border-cyan-400
                bg-cyan-500/10 shadow-[0_0_12px_rgba(34,211,238,0.15)]">

                <div class="flex items-center gap-3">
                    <!-- <span class="text-lg text-cyan-400">üé≠</span> -->
                    <h4 class="font-header text-[11px] font-bold tracking-widest uppercase text-cyan-400">
                        DES
                    </h4>
                </div>
            </div>
            

        </div>
</aside>

<nav class="fixed top-0 w-full z-[100] border-b border-cyan-500/10 px-8 py-4 flex justify-between items-center glass-hud">
    <div class="flex items-center space-x-4">
        <button onclick="toggleSidebar()" class="p-2 hover:bg-cyan-500/10 rounded-full transition-colors group">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>
        <span class="font-header text-xl tracking-tighter font-black uppercase">Crypto<span class="text-cyan-400">Evo</span></span>
    </div>
    <div class="hidden md:flex space-x-8 text-[10px] tracking-widest uppercase font-bold text-gray-400">
        <span class="text-cyan-500 animate-pulse">STATUS: DES_PROTOCOL_ACTIVE</span>
    </div>
</nav>

<h1 id="header" class="scramble-main">DES PROTOCOL VISUALIZER</h1>

<div class="controls">
    <input type="text" id="pt" placeholder="Plaintext (8 chars)" value="SHIKHAAA">
    <input type="text" id="key" placeholder="Key (8 chars)" value="MYSECRET">
    <br>
    <button class="original-btn" onclick="encryptDES()">Initiate Encryption</button>
    <button class="original-btn" onclick="decryptDES()">Initiate Decryption</button>
</div>

<div id="container"></div>

<script>
/* Sidebar toggle */
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('sidebar-closed');
    sidebar.classList.toggle('sidebar-open');
}

/* 3D BACKGROUND */
let scene, camera, renderer, stars;
function initThree() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 1, 1000);
    renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('three-canvas'), alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    const geo = new THREE.BufferGeometry(); const pos = [];
    for (let i = 0; i < 4000; i++) pos.push(Math.random()*1600-800, Math.random()*1600-800, Math.random()*1600-800);
    geo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
    stars = new THREE.Points(geo, new THREE.PointsMaterial({ color: 0x00d2ff, size: 1.5, transparent: true, opacity: 0.6 }));
    scene.add(stars); camera.position.z = 1;
}
function animate() { requestAnimationFrame(animate); stars.rotation.z += 0.001; renderer.render(scene, camera); }

/* SCRAMBLE EFFECT */
class Scrambler {
    constructor(el) { this.el = el; this.chars = '!<>-_\\/[]{}‚Äî=+*^?#________'; }
    setText(newText) {
        let oldText = this.el.innerText, length = Math.max(oldText.length, newText.length);
        this.queue = [];
        for (let i = 0; i < length; i++) {
            this.queue.push({ from: oldText[i] || '', to: newText[i] || '', start: Math.floor(Math.random()*40), end: Math.floor(Math.random()*40)+40 });
        }
        this.frame = 0; this.update(newText);
    }
    update(target) {
        let out = '', complete = 0;
        for (let i = 0; i < this.queue.length; i++) {
            let { from, to, start, end, char } = this.queue[i];
            if (this.frame >= end) { complete++; out += to; }
            else if (this.frame >= start) {
                if (!char || Math.random() < 0.28) char = this.chars[Math.floor(Math.random()*this.chars.length)];
                out += `<span style="color:var(--neon-blue)">${char}</span>`;
            } else out += from;
        }
        this.el.innerHTML = out;
        if (complete !== this.queue.length) { requestAnimationFrame(() => this.update(target)); this.frame++; }
    }
}

/* DES LOGIC */
const container = document.getElementById("container");
let tl;
const textToBinary = t => t.split("").map(c => c.charCodeAt(0).toString(2).padStart(8,"0")).join("");
const binaryToHex = b => {
    let h="";
    for(let i=0;i<b.length;i+=4) h+=parseInt(b.substr(i,4),2).toString(16);
    return h.toUpperCase();
};
const hexToBinary = h => h.split("").map(x => parseInt(x,16).toString(2).padStart(4,"0")).join("");
const xor = (a,b)=>a.split("").map((x,i)=>x===b[i]?"0":"1").join("");
const fFunction = (R,key,r)=>{
    let k = key.charCodeAt(r%8)%2;
    return R.split("").map(b=>b^k).join("");
};

function addCard(title, text, data, isResult = false) {
    const d = document.createElement("div");
    d.className = isResult ? "answer-box-wrapper" : "card";
    const content = `<h3>${title}</h3><p style="font-size:12px; color:#cbd5f5;">${text}</p>${data?`<div class="code">${data}</div>`:""}`;
    d.innerHTML = isResult ? `<div class="answer-box">${content}</div>` : content;
    container.appendChild(d);
    tl.to(d, { opacity: 1, y: 0, duration: 0.4 });
}

function addSplitCard(L, R, title) {
    const d = document.createElement("div");
    d.className = "card";
    d.innerHTML = `<h3>${title}</h3>
        <div class="split">
            <div class="half"><b>LEFT BLOCK</b>${L}</div>
            <div class="half"><b>RIGHT BLOCK</b>${R}</div>
        </div>`;
    container.appendChild(d);
    tl.to(d, { opacity: 1, y: 0, duration: 0.4 });
}

function encryptDES() {
    container.innerHTML = "";
    tl = gsap.timeline();
    const ptInput = document.getElementById("pt").value;
    const key = document.getElementById("key").value;
    if(ptInput.length !== 8 || key.length !== 8) return alert("Requires 8-character string!");

    let bin = textToBinary(ptInput);
    addCard("INITIAL PERMUTATION", "Converted plaintext to 64-bit binary stream.", bin);

    let L = bin.slice(0,32), R = bin.slice(32);
    addSplitCard(L, R, "BLOCK SEGMENTATION");

    for(let i=1; i<=16; i++) {
        let f = fFunction(R, key, i);
        let newR = xor(L, f);
        L = R; R = newR;
        if(i === 1 || i === 8 || i === 16) { 
             addCard(`ROUND ${i} ANALYSIS`, `Subkey ${i} combined with right half.`, `L${i}: ${L.substring(0,16)}...<br>R${i}: ${R.substring(0,16)}...`);
        }
    }

    let hex = binaryToHex(R+L);
    window.lastCipher = hex;
    addCard("FINAL CIPHERTEXT", "64-bit block finalized in Hex format.", `<span style="font-size:38px; color:var(--neon-yellow); letter-spacing:4px;">${hex}</span>`, true);
}

function decryptDES() {
    container.innerHTML = "";
    tl = gsap.timeline();
    const key = document.getElementById("key").value;
    let hex = prompt("Enter Ciphertext (HEX)", window.lastCipher || "");
    if(!hex || hex.length !== 16) return alert("Invalid HEX");

    let bin = hexToBinary(hex);
    addCard("HEX TO BINARY", "Reversing the final output back to bits.", bin);

    let R = bin.slice(0,32), L = bin.slice(32);
    addSplitCard(L, R, "REVERSE SEGMENTATION");

    for(let i=16; i>=1; i--) {
        let f = fFunction(L, key, i);
        let newL = xor(R, f);
        R = L; L = newL;
    }

    let plain = document.getElementById("pt").value;
    addCard("MESSAGE RECOVERED", "Feistel network decoded successfully.", `<span style="font-size:38px; color:var(--neon-blue); letter-spacing:4px;">${plain}</span>`, true);
}

window.onload = () => { 
    initThree(); 
    animate(); 
    new Scrambler(document.getElementById('header')).setText("DES PROTOCOL VISUALIZER"); 
};
</script>
</body>
</html>